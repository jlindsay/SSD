
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>SeaStream Insight: Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- For third-generation iPad with high-resolution Retina display: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./iidx/components/brandkit/favicon/favicon-144px.png">

  <!-- For iPhone with high-resolution Retina display: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./iidx/components/brandkit/favicon/favicon-114px.png">

  <!-- For first- and second-generation iPad: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./iidx/components/brandkit/favicon/favicon-72px.png">

  <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="./iidx/components/brandkit/favicon/favicon.png">

  <link rel="icon" href="./iidx/components/brandkit/favicon/favicon.ico">
  <link href="./iidx/css/iids.css" rel="stylesheet" type="text/css">
  <link href="./iidx/css/responsive.css" rel="stylesheet" type="text/css">

  <!--link href="./iidx/components/bootstrap-switch/static/stylesheets/bootstrap-switch.css" rel="stylesheet" type="text/css"-->

  <link href="./css/hmi.css" rel="stylesheet" type="text/css">
  <!--link href="./css/styles.css" rel="stylesheet" type="text/css"-->

  <!--link href="./css/main.css" rel="stylesheet" type="text/css"-->

  <!--[if lt IE 9]>
    <link id="theme-ie" href="../../css/ie.css" rel="stylesheet" type="text/css">
  <![endif]-->

  <script src="./iidx/components/modernizr/modernizr.js"></script>

<style>
</style>

</head>
<body>

<nav id="navbar" class="navbar navbar-static-top navbar-default" role="navigation" style="display:none;">

  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <a class="navbar-brand" href="./index.html"><span class="ge-logo"></span> <span>SeaStream Insight<small><i>powered by</i> GE Power Conversion</small></span></a>

      <!-- .navbar-toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

  <div class="pull-right profile">
      <div class="btn-toolbar pull-left">
        		
        <div id="btn-analyze" class="btn-group btn-filter pull-left" data-toggle="modal" href="#modal-badge-count">
		  <a class="btn"><img src="./img/sprites/icons/ico_header_analyze.png" /><span class="ds-id">Analyze</span></a>
		  <a id="badge-count-btn" class="btn badge-count">0</a>
		</div>

        <img class="circular" src="./img/sprites/screens/sprite_header_avatar.png" />
      </div>
    </div>
  </div>

  <div class="primary-navbar nav-collapse">
    <div class="container">
		<div id="ship-view-btn" class="btn-group btn-filter pull-left">
		  <a class="btn"><img src="./img/icons/ship-front-icon.png" /><span class="ds-id">DS-04</span></a>
		  <a class="btn btn-remove" href="./fleet-view.html?uuid=201#"><i class="icon-remove"></i></a>
		</div>
		<ul id="master-nav" class="nav navbar-nav">
			<li id="ship-tab"><a href="#ship">
					<svg width="10" height="10"><path d=" M 5 0 L 0 10 L 10 10" fill="#ff0000" /></svg>
					<span>Ship</span>
				</a>
			</li>
		</ul>


      <ul id="fleet" class="nav navbar-nav" style="margin-left:10px;display:none;">
        <li>
        	<a class="active" href="#">
        		<svg height="10" width="10">
  					<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span>A</span>
			</a>
		</li>
        <li>		
        	<a href="#">
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span>B</span>
			</a>
		</li>
        <li>
        	<a href="#">        	
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span>C</span>
			</a>
		</li>
      </ul>

      <ul id="ship" class="nav navbar-nav" style="display:none;">
        <li >
        	<a class="active" href="#bop">
	            <svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">BOP</span>
			</a>
		</li>
        <li>
        	<a href="#well">
	            <svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Well</span>
			</a>
        </li>
        <li>
        	<a href="#riser">        	
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Riser</span>
			</a>
        </li>
        <li id="drillfloor">
        	<a href="#drillfloor">
	        	<!--svg id="drillfloor-warning" class="warning hidden" width="10" height="10">
	        		<path d=" 	M 5 0 
					        	L 0 10 
					        	L 10 10
					        	" fill="#ff9821" /></svg-->
				<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Drillfloor</span>
			</a>
        </li>
        <li>
        	<a href="#fire-and-gas">        	
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Fire & Gas</span>
			</a>
        </li>
        <li>
        	<a href="#power-managment">        	
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Power Managment</span>
			</a>
        </li>
        <li>	
        	<a href="#dynamic-position">        	
	        	<svg height="10" width="10">
	  				<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />
				</svg>
				<span style="margin-left:5px;">Dynamic Positioning</span>
			</a>
        </li>
      </ul>

  </div>

</nav>

<ul id="breadcrumb" class="breadcrumb">
	<li>
		<a href="#">loading...</a>
	</li>
</ul>


<div id="modal-badge-count" class="modal fade">
        <div class="modal-dialog" >
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Badge Count <span id="badge-count-modal">0</span></h4>
                </div>
                <div class="modal-body">
  		          
		            <div class="timeline-left-nav">
		            	<h2>Timeline</h2>
			              <ul class="message-list">
			                <li class="message-item" id="event-0">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Fill pressure normal
			                    </h4>
			                    <p>Pump - Ballast System #2</p>
			                    <time>11 hours ago</time>
			                  </a>
			                </li>
			                <li class="message-item" id="event-1">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Entered tripped state
			                    </h4>
			                    <p>Drive - Ballast System #2</p>
			                    <time>11 hours ago</time>
			                  </a>
			                </li>
			                <li class="message-item" id="event-2">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Value opened
			                    </h4>
			                    <p>Fill valve - Ballast System #2</p>
			                    <time>12 hours ago</time>
			                  </a>
			                </li>
			                <li class="message-item" id="event-3">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Overtemperature warning
			                    </h4>
			                    <p>Motor - Ballast System #2</p>
			                    <time>12 hours ago</time>
			                  </a>
			                </li>
			                <li class="message-item" id="event-4">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Mortor - Ballast System #2
			                    </h4>
			                    <p>Motor -  Ballast System #2</p>
			                    <time>May 1 at 17:05</time>
			                  </a>
			                </li>
			                <li class="message-item" id="event-5">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Valve closed
			                    </h4>
			                    <p>Drain valve - Ballast System #2</p>
			                    <time>April 13 at 15:24</time>
			                  </a>
			                </li>

			                <li class="message-item" id="event-6">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Valve closed
			                    </h4>
			                    <p>Drain valve - Ballast System #2</p>
			                    <time>April 13 at 15:24</time>
			                  </a>
			                </li>

			                <li class="message-item" id="event-7">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Valve closed
			                    </h4>
			                    <p>Drain valve - Ballast System #2</p>
			                    <time>April 13 at 15:24</time>
			                  </a>
			                </li>


			                <li class="message-item" id="event-8">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Valve closed
			                    </h4>
			                    <p>Drain valve - Ballast System #2</p>
			                    <time>April 13 at 15:24</time>
			                  </a>
			                </li>


			                <li class="message-item" id="event-9">
			                  <a href="#">
			                    <!--span class="label label-important pull-left">Fill pressure normal</span-->
			                    <h4 class="message-title">
			                    Valve closed
			                    </h4>
			                    <p>Drain valve - Ballast System #2</p>
			                    <time>April 13 at 15:24</time>
			                  </a>
			                </li>
			                
			              </ul>
		              </div>

		              <div class="timeline-right-nav">
		              		<div id="chart-0" class="panzoom" >
							    <img class="graph" src="./img/sprites/graphs/chart-0.png"/>
							  </div>
							  <div id="chart-1" class="panzoom" >
							    <img class="graph" src="./img/sprites/graphs/chart-1.png"/>
							  </div>
							  <div id="chart-2" class="panzoom" >
							    <img class="graph" src="./img/sprites/graphs/chart-2.png"/>
							  </div>
							  <!--div id="chart-3"  class="panzoom" >
							    <img class="graph" src="./img/sprites/graphs/chart-3.png"/>
							  </div>
							  <div id="chart-4"  class="panzoom" >
							    <img class="graph" src="./img/sprites/graphs/chart-4.png"/>
							  </div-->
		              </div>
                </div>


                <div class="modal-footer" style="clear:both;">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <!--button type="button" class="btn btn-primary">Save changes</button-->
                </div>
            </div>
        </div>
    </div>



<section id="content-body">
	<!-- content is loaded here... -->
</section>


<script src="./iidx/components/requirejs/require.js"></script>
<script src="./iidx/js/require.config.js"></script>
<script type="text/javascript">

	require.config({
    	baseUrl: './iidx/'
  	});



</script>


<script src="./iidx/components/jquery/jquery.js"></script>
<!--script src="./bower/bootstrap/dist/bootstrap.js"></script-->
<script src="./iidx/components/bootstrap/js/modal.js"></script>
<script src="./iidx/components/bootstrap/js/affix.js"></script>
<script src="./iidx/components/bootstrap/js/alert.js"></script>
<script src="./iidx/components/bootstrap/js/button.js"></script>
<script src="./iidx/components/bootstrap/js/carousel.js"></script>
<script src="./iidx/components/bootstrap/js/collapse.js"></script>
<script src="./iidx/components/bootstrap/js/dropdown.js"></script>
<script src="./iidx/components/bootstrap/js/tooltip.js"></script>
<script src="./iidx/components/bootstrap/js/popover.js"></script>
<script src="./iidx/components/bootstrap/js/scrollspy.js"></script>
<script src="./iidx/components/bootstrap/js/tab.js"></script>

<script src="./iidx/components/bootstrap/js/transition.js"></script>
<script src="./iidx/components/bootstrap-switch/static/js/bootstrap-switch.js"></script>


<!--script src="./js/jquery.cookie.js"></script>
<script src="./js/jquery.url.js"></script-->
<script src="./js/globle.js"></script>
<script src="./js/keynote.js"></script>
<!--script src="./js/jquery.scrollTo.js"></script-->
<script>


	require.config({
		baseUrl: './',
		urlArgs: String("r="+ (new Date()).getTime()),
  		paths: {
			'cookies'			: 'js/jquery.cookie',
    		'url'				: 'js/jquery.url',
    		'keynote'			: 'js/keynote',
    		'scrollTo'			:'js/jquery.scrollTo.js',
    		'jquery.panzoom'    : './bower/jquery.panzoom/dist/jquery.panzoom'
		},
		shim: {
			'url': ['jquery'],
			'cookies': ['jquery'],
			'scrollTo' : ['jquery'],
			'jquery.panzoom' : ['jquery'],
		}

	});



	require(['jquery','cookies', 'url', 'keynote','jquery.panzoom'], function($) {
   			console.log("deubg:init()");
   		var _keynote = new Keynote().init( { pages: _pages } );
   			initUI();
	});


	var DEFAULT_TEMPLATE = "./temp/overview.html";
	var _tab;
	var _sub_tab;
	var _sub_nav;
	var _sub_nav_dropdown;
	var _pannels=[];
	var _content_pannels=[];

	function initUI()
	{
		console.log("debug:initUI()");

		$("#master-nav li a").click(function(e){
				//console.log("ping");
				e.preventDefault();
			var elm = $(e.target).attr("href");
				if(!elm){
					elm = $(e.target).closest("a").attr("href");
				}

				console.log("debug:elm:", e.target);
				$("#master-nav li").removeClass("active");
				$(e.target).closest("li").addClass("active");
				_sub_tab = "";
				_sub = "overview";
				//$(location).attr('hash', "#tab=ship&sub=overview")
				
				$("#ship li").removeClass("active");

				focusMainTabs(elm);
		});

		parseURL();

		$("#btn-analyze").click(function(e){
			var badge_count = $("#badge-count").html();	
				console.log("badge_count:",badge_count);
				//$("")
		})
		
		//initCharts();
		initBadge();

	}

	function parseURL()
	{
		console.log("debug:parseURL()");
		//var url = $(location).attr('href');
		var hash = $(location).attr('hash').split("#").join("");

			hash = hash.split("&");

		var hash_params = {};

		$.each( hash , function($index,$val){
			var tmp = $val.split("=");
				hash_params[tmp[0]] = tmp[1];
		});

		_tab 				= hash_params['tab'];
		_sub_tab 			= hash_params['sub-tab'];
		_sub_nav 			= hash_params['sub'];
		_sub_nav_dropdown 	= hash_params['dropdown'];


		switch(_tab)
		{
			
			case "ship":
				focusMainTabs("#ship");
				break;
			/*
			case "fleet":
				focusMainTabs("#fleet");
			 	break;
			*/
			case "index":
			default:
				focusMainTabs("#index");
				break;
		}

	}


	function focusMainTabs(elm_id)
	{
		console.log( "debug:focusMainTabs():elm_id:", elm_id );
//		_nav_id = elem_id ? elem_id : 0;
		$("#fleet").hide();
		$("#ship").hide();
		
		if( !elm_id ){
			return;
		}

		var elm = $("#master-nav").find("a[href='"+elm_id+"']");//
			$("#master-nav li a").removeClass("active");
		if( elm )
		{
			$(elm).closest("li").addClass("active");	
		}else{
			//$("#master-nav li:first").addClass("active");
		}

		$("#navbar").fadeIn();
		$(elm_id).fadeIn();

		var key = elm_id.split("#").join("");


		
		//return;
		console.log("ping:_sub_tab:", _sub_tab, ", _tab:" , _tab);
		switch(elm_id)
		{
			case "#ship":
				if( _sub_tab == "drillfloor" && _tab == "ship" ){
					initSubTab();
					
				}else{
					loadTemplate( "home_ship" );
				}
				
				break;
			case "#index":
			default:
//				loadTemplate( "home_index" );
				break;
		}
	}

	function updateBreadcrum()
	{
		console.log("updateBreadcrum()");

		var hash = "";
		var html = "";

		if( _tab ){
			hash += "tab=" + _tab;
			html += "<li>" + _tab.split("-").join(" ")+"</li>";
		}
		if( _sub_tab ){
			hash += "&sub_tab=" + _sub_tab;
			html += "<li>" + _sub_tab.split("-").join(" ")+"</li>";
		}
		if( _sub_nav && _sub_nav != "" ){
			hash += "&sub=" + _sub_nav;	
			html += "<li>" + _sub_nav.split("-").join(" ")+"</li>";
		}

		if( _sub_nav_dropdown && _sub_nav_dropdown != "" ){ 
			hash += "&dropdown=" + _sub_nav_dropdown;
			html += "<li>" + _sub_nav_dropdown.split("-").join(" ")+"</li>";
		}

//			console.log("updateBreadcrum:hash:", hash);

			$(location).attr('hash', hash  );

			$("#breadcrumb").empty();
			$("#breadcrumb").html(html);
			$("#breadcrumb li:last").addClass("active");
	}

	function initSubTab()
	{
		console.log("debug:initSubTab():_sub_tab", _sub_tab);
		$("#ship li").click(function(e){
				e.preventDefault();
			var elm = $(e.target).closest("li").find("a");
			var href = $(elm).attr("href");
				_sub_tab = href.split("#").join("");
				//_sub_nav = "";
				console.log("sub_tab:click:", href);
				//loadTemplate( _sub_tab );
				$("#master-nav li").removeClass("active");
				$("#ship li").removeClass("active");
				$(elm).closest("li").addClass("active");
				focusSubtab();
				//updateBreadcrum();
		});
		focusSubtab();
		//focusSubNav();
		//updateBreadcrum();


	}

	function focusSubtab()
	{
		//console.log("focusSubtab():sub_tab:", _sub_tab );
		if(!_sub_tab){
			return;
		}
		
		switch( _sub_tab )
		{
			case "drillfloor":
				//console.log("ping:focusSubtab:", _sub_tab);
				//console.log("svg:", $("#drillfloor svg.warning") );

				$("#master-nav li").removeClass("active");
				
				console.log( "ping()", $("#ship svg") );
				$("#ship-tab svg").remove();
				$("#ship-view-btn .ds-id").html("DS-01");

				$("#ship-tab a").prepend('<svg height="10" width="10">   \
  					<circle cx="5" cy="5" r="5" stroke="black" stroke-width="0" fill="#3c95f5" />   \
				</svg>');



				$("#drillfloor svg").remove();
				$("#drillfloor ").addClass("active");
				$("#drillfloor a").prepend('<svg width="10" height="10"><rect width="10" height="10" style="fill:rgb(255 , 237 ,69);stroke-width:2;stroke:rgb(151 ,151, 151)" /></svg>');

				
				loadTemplate( "home_ship_drillfloor" );
				break;
/*			case "#bop":
				loadTemplate( "home_ship_bop" );
				break;
			case "#well":
				loadTemplate( "home_ship_well" );
				break;
			case "#riser":
				loadTemplate( "home_ship_riser" );
				break;
			
			case "#fire-and-gas":
				loadTemplate( "home_ship_fire-and-gas" );
				break;
			case "#power-managment":
				loadTemplate( "home_ship_power-managment" );
				break;
			case "#dynamic-position":
				loadTemplate( "home_ship_dynamic-position" );
				break;
*/
			default:
				break;
		}
	}

	function initSubNav()
	{
		console.log("debug:initSubNav()");

		$("#left-nav ul.systems-overview li a").off();
		$("#left-nav ul.systems-overview li a").click(function(e){
			//console.log("click:");
		});

		$("#left-nav ul li.level-0").off();
		$("#left-nav ul li.level-0").click(function(e){

				e.preventDefault();

				if( $( e.target ).hasClass("level-1") ){
					//NOTE: this is a hack, to get around the nest "ul li a"
					return;
				}

				var key;
				try{
					key = $( e.target ).attr('href').split("#").join("");		
				}catch(e){}
				
				//NOTE: disabling everything except for 'ballast-and-bilge'
				if( !key || key != 'ballast-and-bilge' && key != 'overview' && key != 'home_ship_drillfloor_top-drive' ) {
					console.log("display nothing except ballast-and-bilge or overview");
					return;
				}

				$("#left-nav ul li.level-0").removeClass("selected");
				$(e.target).closest( "li").addClass("selected");
				console.log("level-0:click:", e.target );
				focusSubNav( key );	

				if( $(e.target).closest("li.level-0").find("ul") != null )
				{
					$(e.target).closest("li.level-0").find("ul").slideToggle();	
					//NOTE: Disabling the auto select first child
					//$(e.target).closest("li.level-0").find("ul li:first").trigger("click");
				}else{
					//
				}

		});

		if( !_sub_nav || _sub_nav == "" ){
			$("#left-nav ul li.level-0:first a").trigger("click");	
		}else{
			$("#left-nav ul li.level-0 a").each(function(index,elm){
				var val = $(elm).attr("href").split("#").join("");
				if( _sub_nav == val )
				{
					console.log("match:", _sub_nav, ", val:", val );
					$(elm).trigger("click");
				}
			})
		}


		$(".left-nav-tree li.level-1").off();
		//"system-1"
		$(".left-nav-tree li.level-1").click(function(e){
			e.preventDefault();
			//console.log("xxxxxxxxxx", $(e.target).closest("li").attr("id") );
			var id = $(e.target).closest("li").attr("id");
			//NOTE: disabling all options except for system-2
			if( id != "system-2" ){
				return
			}

			$(e.target).closest(".level-0").removeClass("selected");
			$(e.target).closest(".level-0").addClass("active-dropdown");


			_sub_nav_dropdown = $(e.target).closest("li").find("span").attr("data").split("#").join("") ;
			console.log("level-1:click:", _sub_nav_dropdown );
			$(".left-nav-tree li").removeClass("selected");
			$(e.target).closest("li").addClass("selected");

			loadSubNavDropdownContentTemplate(_sub_nav_dropdown);
			updateBreadcrum();
		});

		if( !_sub_nav_dropdown || _sub_nav_dropdown == "" ){
			//$("#left-nav-tree ul li:first a").trigger("click");
		}

	}

	function initSubTabs()
	{
		console.log("debug:initSubTabs()");
		$("#fleet li").off();
		$("#fleet li").click(function(e){
			console.log("debug:initSubTabs:CLICK()");
		});

	}


	function focusSubNav(key)
	{
		console.log( "debug:focusSubNav():key:", key );				
		loadSubNavContentTemplate(key);
		$('.left-nav-tree').hide();
		$('.left-nav-tree li').removeClass("selected");
		//$('.left-nav-tree').slideToggle();	

		_sub_nav = key;
		_sub_nav_dropdown = undefined;
		updateBreadcrum();
	}

	function loadSubNavDropdownContentTemplate(key)
	{
			console.log( "debug:loadSubNavDropdownContentTemplate():key:", key );
		var template = "./temp/sub_dropdown/"+key+".html";
	
			$("#content-pannels").fadeOut("fast", function(e){
				$("#content-pannels").empty();
				$("#content-pannels").load( template , function(responseText, textStatus, XMLHttpRequest)
				{
	            	$("#content-pannels").fadeIn("fast", function(e){
	            		//
	            	});
	        	});
			});

			loadSubNavTemplate(key);
	}


	function loadSubNavContentTemplate(key)
	{
			console.log( "debug:loadSubNavContentTemplate():key:", key );
			
		var template = "./temp/sub/"+key+".html";
//			console.log( "debug:loadSubNavContentTemplate():template:", template );
			//$("#content-pannels")
			//$("#asset-pannels")
			$("#content-pannels").fadeOut("fast", function(e){
//				console.log("debug:loadSubNavContentTemplatefadeout():complete");
				$("#content-pannels").empty();
				$("#content-pannels").load( template , function(responseText, textStatus, XMLHttpRequest)
				{
					//$("#content-pannels")
					_content_pannels = $("#content-pannels .pannel");
	            	$("#content-pannels").fadeIn("fast", function(e){
//	            		console.log("debug:content-pannels.fadeIn():complete");
	            	});
	        	});
			});

			loadSubNavTemplate(key);
	}
	
	function loadSubNavTemplate(key)
	{
			console.log( "debug:loadSubNavTemplate():key:", key );
		var template = "./temp/nav/"+key+".html";
			console.log( "debug:loadTemplate():template:", template );

			$(document).on('scroll', function(e) {
    			var scrollPercent = ($(window).scrollTop() / $(document).height()) * 100;
			    $.each(_pannels, function(index,elm){
				    
			    	try{
			    		if( ( Number( $(window).scrollTop() ) + 99 ) > $( _content_pannels[index] ).position().top ){
				    		$(".asset-pannel").removeClass("selected");
				    		$(elm).addClass("selected");
				    	}	
			    	}catch(e){}
				    
			    });
			});
			
			

			$("#asset-pannels").fadeOut("fast", function(e){
				console.log("debug:asset-pannels:fadeout():complete");

            	$("#asset-pannels").fadeIn("fast", function(e){
            		console.log("fadeIn()");
            	});
	            


				$("#asset-pannels").empty();
				$("#asset-pannels").load( template , function(responseText, textStatus, XMLHttpRequest)
				{
	            	console.log( "total-asspet-pannels:", $("#asset-pannels .asset-pannel").length );
					_pannels = $(".asset-pannel");

		            $(".asset-pannel").removeClass("selected");
		            $(".asset-pannel:first").addClass("selected");

		            $(".asset-pannel li a").click(function(e){
		            	e.preventDefault();
		            	
		            	var elm = $(e.target ).closest("li").find("a");//.attr("href");
		            	console.log( "debug:click:", elm );
		            	var offset = Number( $( $(elm).attr('href') ).offset().top ); 
		            		offset -= 115;
		            		console.log("offset:", offset);
		            	$("html, body").animate({ scrollTop:  offset }, 500);

		            	$(".asset-pannel").removeClass("selected");
		            	$(e.target).closest(".asset-pannel").addClass("selected");

		            	//$("#asset-pannels").animate({ scrollTop: $( $(e.target).attr('href') ).offset().top }, 500);

						
	            	});

	        	});
			});
	}
	
	function loadTemplate(key)
	{
			console.log("debug:loadTemplate():key:", key);
		var template = ( key )? "./temp/"+key+".html" : DEFAULT_TEMPLATE ;
			console.log("debug:loadTemplate():template:", template);

		//var hash = $(location).attr('hash').split("#").join("");


		$("#content-body").fadeOut("fast", function(e){
			console.log("fadeout()::complete");
			$("#content-body").empty();
			$("#content-body").load( template , function(responseText, textStatus, XMLHttpRequest)
			{
            	$("#content-body").fadeIn("fast", function(e){
            		console.log("fadeIn()");
            	});

            	initSubTabs();
            	initSubNav();
        	});
		});
	}


	function initBadge()
	{
		$("#btn-analyze").click(function(e){
			console.log();
			
		});
		initCharts();
	}



	function initCharts()
	{
		var _offset = 0;

		//$(".timeline-left-nav .message-list .message-item a").off();
		$(".timeline-left-nav .message-list .message-item a").on("click", function(e){
			e.preventDefault();

			var id = $( e.target ).closest("li").attr("id").split("event-").join("") ;
				id = Number(id);			

				_offset = ( 1600/ 9 ) * id ;

			var width = 1600;
			var _x = _offset;
			var delta_x = 1600;

				console.log("offset:", _offset );
			$(".panzoom").panzoom( "pan", _offset, 0, {
	            relative: true,
	            animate: true
	        });

		});
  			

		function panleft()
		{
			$('#panzoom img').animate({
					marginLeft: "-=0.5in"
				}, 1000, function() {
			});
		}

		function panright()
		{
			$('#panzoom img').animate({
					marginLeft: "+=0.5in"
				}, 1000, function() {
			});
		}


///*
    	 var $panzoom = $('.panzoom').panzoom();
            
            $panzoom.parent().on('mousewheel.focal', function( e ) {
                        //console.log(e);
                        e.preventDefault();
                        
                        //$(".graphs").remove();
                    //var delta = e.delta || e.originalEvent.wheelDelta;
                    //var zoomOut = delta ? delta < 0 : e.originalEvent.deltaY > 0;
                        //console.log(zoomOut);
                        /*
                        $panzoom.panzoom('pan', -400, {
                            increment: 0.1,
                            animate: false,
                            focal: e
                });
						*/                

            });
//*/
	}



	

</script>

<script src="./iidx/components/respond/respond.src.js"></script>

</body>
</html>



